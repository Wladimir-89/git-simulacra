#!/bin/bash
set -e

# [Шоттс] Мы начинаем с простой цели — добавить файл в репозиторий.

echo "Добавление изменений"
echo "Команда git add"

DATE=$(date)
GIT_USER=$(whoami)
HOST=$(hostname -f)

# [Бодрийяр] Ах, переменные... Ты думаешь, ты фиксируешь время, пользователя,
# машину...
# На самом деле ты фиксируешь маску — след отпечатка, не источник.

if command -v git > /dev/null 2>&1;
then

  # [Шоттс] Вот мы создаём директорию и переходим в неё.
  # Это базовая операция подготовки.

  # [Бодрийяр] Создание папки — ритуал инициации. Преобразование пустоты в псевдо-
  # пространство истории.
  mkdir -p git-add-example
  cd git-add-example || { echo "Невозможно перейти в каталог"; exit 1; }
  git init --quiet

  # [Шоттс] Создаём файл. Это будет наш объект отслеживания.
  # [Бодрийяр] Это не объект. Это — его представление. Мы не создаём файл,
  # мы создаем идею файла.
  
  echo "Привет, мир!" > example.txt
  git add example.txt

  # [Шоттс] Теперь мы добавляем файл в индекс. Он готов к фиксации в истории.
  # [Бодрийяр] Но индекс — это не история. Это антикварная полка, где вещи ждут
  # признания.
  # Пока нет коммита — нет прошлого. Есть только возможность его симуляции.

  echo "Added example.txt at $DATE by $GIT_USER on $HOST"
  cd ..
else 
  echo "Установите git"

  # [Шоттс] Git — это необходимый инструмент управления версиями.
  # [Бодрийяр] Git — это культ контроля. Но под ним — паника перед хаосом
  # изменений.
fi
