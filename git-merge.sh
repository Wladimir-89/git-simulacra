#!/bin/bash
set -e

# Шоттс: Слияние веток — акт объединения разных путей.
# Бодрийяр: Объединение — лишь попытка смягчить раздвоение симулякров.

echo "Слияние веток"
echo "Команда git merge"

if command -v git > /dev/null 2>&1;
then
  # Шоттс: Проверяем версию Git — гарантию стабильности.
  # Бодрийяр: Версия — лишь маркировка бренда, не сути.

  echo "Git installed, version $(git --version)"

  # Шоттс: Создаём новую директорию для эксперимента.
  # Бодрийяр: Пространство вновь создаётся, ожидая наполнения смыслом.

  mkdir -p git-merge-example
  cd git-merge-example || { echo "НЕвозможно перейти в каталог"; exit 1; }

  # Шоттс: Инициализируем репозиторий с главной веткой main.
  # Бодрийяр: Главная ветка — миф, вокруг которого строится спектакль.

  git init --quiet --initial-branch=main

  # Шоттс: Первая версия — основа для всего.
  # Бодрийяр: Основа — лишь точка старта в бесконечном лабиринте изменений.

  echo "Первая версия"
  echo "Привет, мир!" > example.txt

  # Шоттс: Добавляем и фиксируем файл.
  # Бодрийяр: Ты словно ставишь метку на песке времени.

  git add example.txt
  git commit -m "example.txt added"

  # Шоттс: Вторая версия — ответвление от главного пути.
  # Бодрийяр: Ответвление — игра с множеством возможных миров.

  echo "Вторая версия"
  git switch -c special

  # Шоттс: Вносим изменение в файл.
  # Бодрийяр: Изменение — знак жизни и хаоса внутри симуляции.

  echo "Изменение в файле" >> example.txt
  git add example.txt
  git commit -m "changes in example.txt"

  # Шоттс: Возвращаемся в main, чтобы объединить изменения.
  # Бодрийяр: Возвращение — иллюзия единства и завершённости.

  git switch main
  git merge special

  # Шоттс: Смотрим лог — историю слияния.
  # Бодрийяр: История — повествование, сплетённое из множества голосов.

  git log --oneline

  cd ..
else
  # Шоттс: Git не установлен — пора исправлять.
  # Бодрийяр: Отсутствие инструмента — окно свободы от симулякров.

  echo "Установите git"
fi


